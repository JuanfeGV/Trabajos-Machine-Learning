{% extends "base.html" %}
{% block title %}Ejercicios de Regresión Logística{% endblock %}
{% block content %}

<h1><b>Ejercicio práctico de regresión logística</b></h1>

<div class="card p-3 mb-3">
    <h5>Generar gráfica de regresión</h5>
    <p>Haz clic en una de las variables para analizar su relación con la renuncia del empleado:</p>

    <div class="row text-center">
        <div class="col-md-3 mb-2">
            <a href="{{ url_for('logicalregression', var='antiguedad') }}" class="btn btn-outline-primary w-100">
                Antigüedad en la empresa
            </a>
        </div>
        <div class="col-md-3 mb-2">
            <a href="{{ url_for('logicalregression', var='salario') }}" class="btn btn-outline-success w-100">
                Nivel salarial
            </a>
        </div>
        <div class="col-md-3 mb-2">
            <a href="{{ url_for('logicalregression', var='area') }}" class="btn btn-outline-warning w-100">
                Área de trabajo
            </a>
        </div>
        <div class="col-md-3 mb-2">
            <a href="{{ url_for('logicalregression', var='horas_extra') }}" class="btn btn-outline-danger w-100">
                Horas extra
            </a>
        </div>
    </div>
</div>

{% if variable %}
<div class="card p-3 mb-3">
    <h5>Resultados del modelo</h5>
    <p><b>Variable seleccionada:</b> {{ variable }}</p>
    <p><b>Exactitud del modelo:</b> {{ accuracy }}</p>

    <div class="mt-3 text-center">
        {% if variable.lower() == "antiguedad" %}
            <img src="{{ url_for('static', filename='images/antiguedad.png') }}" width="600" height="400" class="img-fluid rounded shadow" alt="Antiguedad">
        {% elif variable.lower() == "salario" %}
            <img src="{{ url_for('static', filename='images/salario.png') }}" width="600" height="400" class="img-fluid rounded shadow" alt="Salario">
        {% elif variable.lower() == "area" %}
            <img src="{{ url_for('static', filename='images/area.png') }}" width="600" height="400" class="img-fluid rounded shadow" alt="Área de trabajo">
        {% elif variable.lower() == "horas_extra" %}
            <img src="{{ url_for('static', filename='images/horas_extra.png') }}" width="600" height="400" class="img-fluid rounded shadow" alt="Horas extra">
        {% endif %}
    </div>

    <div class="mt-4">
    <h6>Reporte de clasificación</h6>

    {% if report %}
    <table class="table table-striped table-bordered text-center">
        <thead>
            <tr>
                <th>Clase</th>
                <th>Precisión</th>
                <th>Recall</th>
                <th>F1-score</th>
                <th>Soporte</th>
            </tr>
        </thead>
        <tbody>
            {% for label, metrics in report.items() %}
                {% if label not in ["accuracy", "macro avg", "weighted avg"] %}
                <tr>
                    <td>{{ label }}</td>
                    <td>{{ metrics.precision | round(4) }}</td>
                    <td>{{ metrics.recall | round(4) }}</td>
                    <td>{{ metrics['f1-score'] | round(4) }}</td>
                    <td>{{ metrics.support }}</td>
                </tr>
                {% endif %}
            {% endfor %}
            <tr class="table-info">
                <td>Accuracy</td>
                <td colspan="4">{{ accuracy }}</td>
            </tr>
        </tbody>
    </table>
    {% endif %}
</div>

</div>
{% endif %}

{% endblock %}
